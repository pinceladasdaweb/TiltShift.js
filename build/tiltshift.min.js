/*! tiltshift 0.0.2 | (c) 2015 Pedro Rog√©rio | MIT License */
!function(a,b){"function"==typeof define&&define.amd?define("tiltshift",b):"object"==typeof exports?module.exports=b():a.TiltShift=b()}(this,function(){"use strict";var a=function(){return this&&this instanceof a?(this.frames=document.querySelectorAll(".tiltshift"),this.defaults={},void this.run()):new a};return a.prototype={run:function(){Array.prototype.forEach.call(this.frames,function(a){this.config(a),this.wrap(a),this.appendEls(a),this.effects(a)}.bind(this))},create:function(a,b){var c,d=document.createElement(a);for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);return d},config:function(a){return this.defaults={s_position:a.dataset.position,s_blur:a.dataset.blur,s_focus:a.dataset.focus,s_falloff:a.dataset.falloff,s_direction:a.dataset.direction},this.defaults},wrap:function(a,b){return b=b||this.create("div",{className:"tiltshift-wrap"}),a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b),b.appendChild(a)},appendEls:function(a){var b=this.create("div",{className:"tiltshift-before tiltshift-layer"}),c=this.create("div",{className:"tiltshift-after tiltshift-layer"}),d=a.getAttribute("src");b.style.backgroundImage="url("+d+")",c.style.backgroundImage="url("+d+")",a.parentNode.appendChild(b),a.parentNode.appendChild(c)},effects:function(a){var b,c,d,e=a.parentNode.querySelectorAll(".tiltshift-layer"),f=(this.defaults.s_position-this.defaults.s_focus/2)/100,g=(100-this.defaults.s_position-this.defaults.s_focus/2)/100,h=(100*(f-this.defaults.s_falloff/100)).toFixed(2),i=(100*(g-this.defaults.s_falloff/100)).toFixed(2);f*=100,g*=100,"y"===this.defaults.s_direction?(b="270deg",c="90deg"):"x"===this.defaults.s_direction?(b="180deg",c="0deg"):(d=this.defaults.s_direction%360,b=d+180+"deg",c=d+"deg"),Array.prototype.forEach.call(e,function(a){a.style.webkitFilter="blur("+this.defaults.s_blur+"px) contrast(105%) saturate(105%)",a.classList.contains("tiltshift-before")&&(a.style.webkitMaskImage="-webkit-linear-gradient("+b+", rgba(0,0,0,1) 0, rgba(0,0,0,1) "+h+"%, rgba(0,0,0,0) "+f+"%)"),a.classList.contains("tiltshift-after")&&(a.style.webkitMaskImage="-webkit-linear-gradient("+c+", rgba(0,0,0,1) 0, rgba(0,0,0,1) "+i+"%, rgba(0,0,0,0) "+g+"%)")}.bind(this))}},a});